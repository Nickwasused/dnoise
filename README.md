# dnoise
DNS noise generator that looks at your network activity and blends in. Requires [pi-hole](https://pi-hole.net) to run.

![dnoise blended into organic traffic](https://github.com/Nickwasused/dnoise/blob/master/traffic.png)
The blue graph line marks queries generated by dnoise, blending in with peaks and valleys of organic traffic.

## Dependencies
### Raspberry Pi

```
sudo apt install python3-venv
python3 -m venv .
source bin/activate
pip3 install -r requirements.txt
sudo apt install python3-pandas
```

### Other
```
sudo apt install python3-venv
python3 -m venv .
source bin/activate
pip3 install -r requirements.txt
```

## Recommended setup
- Use [Unbound](https://docs.pi-hole.net/guides/dns/unbound/) or [Knot-resolver](https://knot-resolver.readthedocs.io/en/stable/quickstart-install.html)
- Pair this with [dnscrypt-proxy](https://github.com/jedisct1/dnscrypt-proxy) or some other DNSCrypt/DoH client to make sure your ISP can't snoop on your queries.

1. Run this on the same machine that hosts your pi-hole instance.
2. Rename the `config.example.json` to `config.json`
3. Fill in the auth field of the config by getting the `WEBPASSWORD` from the Pi-hole config by typing `sudo cat /etc/pihole/setupVars.conf` on the Pi-hole server.
4. That's all there is to it. The script will sample network activity every minute and add 10% extra DNS queries made randomly to Cisco's top 1M domain list.

## Automatic start

You obviously need to change the path `home/pi/dnoise` to your path.

- Put this in your `crontab -e` to make it run after reboot: `@reboot /home/pi/dnoise/bin/python3 /home/pi/dnoise/dnoise.py`
- Systemd service:  
```
[Unit]
Description=dnoise service
After=network.target
StartLimitIntervalSec=0

[Service]
SyslogIdentifier=noise
Type=simple
User=pi
ExecStart=/home/pi/dnoise/bin/python3 /home/pi/dnoise/dnoise.py
WorkingDirectory=/home/pi/dnoise
Environment=PYTHONUNBUFFERED=1
PrivateTmp=true
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=false
ReadOnlyDirectories=/
ReadWriteDirectories=/home/pi/dnoise/

[Install]
WantedBy=multi-user.target
```
